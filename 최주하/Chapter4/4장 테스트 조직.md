
# 4장. 테스트 조직
>📝 **4장 학습 내용**
>
>- AAA 구조를 사용하여 테스트를 구조화하기 → 가독성 향상과 일관성을 지킬 수 있다!
>- 메서드를 테스트하는 것이 아닌 **동작을 테스트** 한다! → 테스트 코드의 유지 보수성 향상
>- 테스트 이름도 잘 지어야 한다.. 🥹🥹
>- 애너테이션을 활용하여 공통 초기화 및 정리 코드를 설정할 수 있다!
>- 주석처리 하지 않고 테스트를 무시하는 법 (@Ignore에서 @Disable로)


## 4.1 AAA로 테스트 일관성 유지

---

패턴을 활용하면 테스트의 가독성 향상과 일관성을 지킬 수 있다. 그 중 AAA 패턴에 대해서 다루었다. AAA는 **트리플-A**라고도 부른다. AAA는 각각 **Arrange(준비), Act(실행), Assertion(단언)**을 의미한다.

- **`준비(Arrange)`**: 테스트 코드를 실행하기 전에 환경을 설정하는 단계를 말한다.
    - 변수/객체 생성, 객체 초기화, 상태 설정 등이 준비 단계에 해당한다.
- **`실행(Act)` :** 테스트 코드가 실행되는 단계이다. 테스트 대상이 되는 코드를 호출한다.
- **`단언(Assertion)` :** 실행한 코드가 기대한 대로 동작하는지 확인하는 단계이다.
- **`사후(After)`** : 부가적인 단계로 테스트를 실행할 때, 할당한 자원이 정리되었는지 확인하는 단계이다.

각 단계의 사이에는 빈 줄을 삽입하여 가독성을 높인다.


## 4.3 테스트와 프로덕션 코드의 관계

---

- 프로덕션 코드: 실제로 서비스 되는 코드. 사용자가 사용하는 코드.
- 테스트 코드: 프로덕션 코드가 원하는 대로 동작하는지 확인하기 위한 코드



>**🤔 프로덕션 소프트웨어를 배포할 때 테스트를 포함하지 않는 이유❓**
>
>- 로딩하는 JAR 파일의 부피가 커짐
>- 코드 베이스의 공격 표면이 늘어남.

## 4.4 하나의 테스트에서는 하나의 목적만 가지기

---

테스트를 분리하면 좋은 점

- 어느 동작에서 문제가 있는지 빠르게 파악할 수 있다
- 다른 테스트의 영향을 제거할 수 있다
- 모든 케이스가 실행됨을 확인할 수 있다.

## 4.5 문서 역할을 잘하기 위해서..

---

단위 테스트는 문서의 역할을 하기도 한다. 문서의 역할을 잘하기 위해서는 테스트의 이름을 잘 지어야 한다.

책에서 AAA 패턴의 테스트인 경우, 제시하는 테스트 이름 양식이 있다.

- doingSomeOperationCeneratesSomeResult(어떤 동작을 하면 어떤 결과가 나온다)
- someResultOccursUnderSomeCondition(어떤 결과는 어떤 조건에서 발생한다)

그리고, 다음과 같은 방법으로 테스트 코드를 리팩토링할 수 있다.

- 지역 변수 이름 바꾸기
- 의미 있는 상수 작성하기
- 햄크레스트 단언 사용하기
- 하나의 테스트가 많은 동작을 포함하지 않도록 하기
- 공통적인 초기화 코드나 정리 코드는 애너테이션(@BeforeEach, @AfterEach)을 붙인 메서드로 이동시키기

## 4.6 어노테이션을 통해 공통 초기화와 정리를 하자!

---

| **junit4** | **junit5** | **설명** |
| --- | --- | --- |
| @Before | @BeforeEach | 각각의 테스트 메서드가 실행되기 전에 실행된다. 해당 어노테이션이 붙은 테스트 메서드를 여러 개 만들 수 있으나 순서를 보장하지 않는다. 원하는 순서가 있는 경우, @Order를 사용한다.  |
| @BeforeClass | @BeforeAll | 모든 테스트 메서드가 실행되기 전 한번만 실행된다. |
| @After | @AfterEach | 각각의 테스트가 실행되고 난 후 실행된다. |
| @AfterClass | @AfterAll | 테스트 클래스에 있는 모든 테스트 메서드가 모두 실행된 후, 한 번만 실행된다. |

## 4.7 테스트를 무시하는 방법!

---

junit4에서는 @Ignore을 사용하여 테스트를 무시했지만, **junit5**는 **@Disable로 변경**되었다.